<!DOCTYPE html>
<html>
<head>
    <title></title>
	<meta charset="utf-8" />
</head>
<body>

    <script>

        var nesting = 0;
        var indent = function () { var s = ''; for (var i = 0; i < nesting; i++) s += '  '; return s; };

        var showHide = function (id, pid) {
            console.log(indent() + "showHide(" + id + ", " + pid + "){");
            nesting++;
            //
            $('div:visible:last').css("border-bottom", "none");
            var element = $("." + id);
            var pelement = $("." + pid);
            var imageTD = pelement.filter('#' + id).find('#image');

            if (pelement.css("display") == "none") {
                element.toggle(false);
                imageTD.attr('class', 'collapsed');
                console.log(indent() + "click-1");
                element.click();
            } else {
                element.toggle();
                if (element.css("display") == "none") {
                    imageTD.attr('class', 'collapsed');
                    console.log(indent() + "click-2");
                    element.click();
                } else {
                    imageTD.attr('class', 'expanded');
                }
            }
            $('div:visible:last').css("border-bottom", "1px solid black");
            //
            nesting--;
            console.log(indent() + "}");
        };
      
        window.onload = function () {
            $(".failed").click();
            $(".passlog").click();
            $('div:visible:last').css("border-bottom", "1px solid black");
        };
    </script>


    <script>


        runner.on('suite end', function (suite) {
            if (suite.root) { // do not do anything if its the root
                root = suite;
                return;
            }

            var depth = suite.depth;

            var id = suite.guid;
            var pid = suite.parent.guid;

            var tests = '';

            var htmlTestFailed = function (test, suite) {
                var html = '';
                //
                html += '<table cellspacing="0" cellpadding="0">' +
                    '<tr id="' + suite.guid + 'err' + status.fail + '" onclick="showHide(\'' + suite.guid + 'err' + status.fail + '\', \'' + suite.guid + '\')" class="' + suite.guid + ' failed">' +
                    addIndentation(suite.depth + 1) + // tests reside one step deaper than its parent suite
                    '<td id="image" class="expanded"></td>' +
                    '<td class="duration">' + test.duration + ' ms</td>' +
                    '<td class="title">' + suite.guid + ": " + test.title + '</td>' +
                    '<td class="failedState">Failed</td>' +
                    '</tr>' +
                    '</table>';

                html += '<table cellspacing="0" cellpadding="0">' +
                    '<tr class="' + suite.guid + 'err' + status.fail + ' failed">' +
                    addIndentation(suite.depth + 2) +
                    '<td class="failDetail">' +
                    '<pre style="font-family: \'Courier New\', Courier, monospace;">' +
                    '<code>' + ((test.log != undefined) ? '|Test Logs|\n' + test.log + '\n' : '') + '|Error Message|\n' + test.err + '</code>' +
                    '</pre>' +
                    '</td>' +
                    '</table>';
                //
                return html;
            };

            suite.tests.forEach(function (test, index, array) {
                var state = test.state

                if (state == 'failed') {
                    status.fail++;
                    status.duration += (test.duration != undefined) ? test.duration : 0;
                    tests += '<table cellspacing="0" cellpadding="0">' +
                        '<tr id="' + id + 'err' + status.fail + '" onclick="showHide(\'' + id + 'err' + status.fail + '\', \'' + id + '\')" class="' + id + ' failed">' +
                        addIndentation(depth + 1) + // tests reside one step deaper than its parent suite
                        '<td id="image" class="expanded"></td>' +
                        '<td class="duration">' + test.duration + ' ms</td>' +
                        '<td class="title">' + id + ": " + test.title + '</td>' +
                        '<td class="failedState">Failed</td>' +
                        '</tr>' +
                        '</table>';

                    tests += '<table cellspacing="0" cellpadding="0">' +
                        '<tr class="' + id + 'err' + status.fail + ' failed">' +
                        addIndentation(depth + 2) +
                        '<td class="failDetail">' +
                        '<pre style="font-family: \'Courier New\', Courier, monospace;">' +
                        '<code>' + ((test.log != undefined) ? '|Test Logs|\n' + test.log + '\n' : '') + '|Error Message|\n' + test.err + '</code>' +
                        '</pre>' +
                        '</td>' +
                        '</table>';

                } else if (state == 'passed') {
                    status.pass++;
                    status.duration += (test.duration != undefined) ? test.duration : 0;
                    if (config.mode == SILENT) return; // if running silent mode dont print anything

                    if (config.mode == VERBOSE && test.log != undefined) {

                        tests += '<table cellspacing="0" cellpadding="0">' +
                           '<tr id="' + id + 'pass' + status.pass + '" onclick="showHide(\'' + id + 'pass' + status.pass + '\', \'' + id + '\')" class="' + id + ' passed passlog">' +
                           addIndentation(depth + 1) + // tests reside one step deaper than its parent suite
                           '<td id="image" class="expanded"></td>' +
                           '<td class="duration">' + test.duration + ' ms</td>' +
                           '<td class="title">' + id + ": " + test.title + '</td>' +
                           '<td class="passedState">Passed</td>' +
                           '</tr>' +
                           '</table>';

                        tests += '<table cellspacing="0" cellpadding="0">' +
                            '<tr class="' + id + 'pass' + status.pass + ' passed">' +
                            addIndentation(depth + 2) +
                            '<td class=".passDetail">' +
                            '<pre style="font-family: \'Courier New\', Courier, monospace;">' +
                            '<code>' + test.log + '</code>' +
                            '</pre>' +
                            '</td>' +
                            '</table>';

                    } else {
                        tests += '<table cellspacing="0" cellpadding="0">' +
                            '<tr class="' + id + ' passed" >' +
                            addIndentation(depth + 1) + // tests reside one step deaper than its parent suite
                            '<td class="durationPorP">' + test.duration + ' ms</td>' +
                            '<td class="title">' + id + ": " + test.title + '</td>' +
                            '<td class="passedState">Passed</td>' +
                            '</tr>' +
                            '</table>';
                    }


                } else if (test.pending) {
                    status.pending++;
                    if (config.mode != SILENT) {
                        tests += '<table cellspacing="0" cellpadding="0">' +
                            '<tr class="' + id + ' pending" >' +
                            addIndentation(depth + 1) +
                            '<td class="durationPorP">0 ms</td>' +
                            '<td class="title">' + id + ": " + test.title + '</td>' +
                            '<td class="pendingState">Pending</td>' +
                            '</tr>' +
                            '</table>';
                    }
                }
            });

            var result = generateResult(suite);
            var display = '';
            display += '<table cellspacing="0" cellpadding="0">' +
                '<tr id="' + id + '" onclick="showHide(\'' + id + '\', \'' + pid + '\')" class="' + pid + ' suite">' +
                addIndentation(depth) +
                '<td id="image" class="expanded"></td>' +
                '<td class="title">' + pid + ": " + suite.title + '</td>' +
                '<td class="subTotal" style="color: DarkGreen;">Pass: ' + result.pass + '</td>' +
                '<td class="subTotal" style="color: DarkRed;">Fail: ' + result.fail + '</td>' +
                '<td class="subTotal" style="color: DarkBlue;">Pend: ' + result.pending + '</td>' +
                '<td class="subTotal" style="color: black; width: 120px;">' + getTime(result.duration) + '</td>' +
                '</tr></table>';
            display += tests;

            suite.htmlDisplay = display;
        });


    </script>



</body>
</html>
